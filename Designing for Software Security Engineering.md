# Designing for Software Security Engineering
## Part 1: Threat Modeling
### Data Flow Diagram
![Diagram](https://github.com/UNO-CYBR-8420-Team1/CYBR8420-Suricata/blob/main/Threat%20Modeling%20Brainstorm/Final%20DFD%20Design%20Image.png)
### [HTML Report From Microsoft Threat Modeling Tool](https://htmlpreview.github.io/?https://github.com/UNO-CYBR-8420-Team1/CYBR8420-Suricata/blob/main/Threat%20Modeling%20Brainstorm/Suricata%20DFD%20Report.htm)
## Part 2: Observations
### Design Related Issues With Suricata

One observation we've seen with the threat analysis is the security of the system is really rooted in the security of the environment it runs in. We interpret this with the observation from the threat modeling tool analysis that the data Suricata stores and interacts with are local files that it generates or reads from. An example to reinforce this observation is the lack of a "login" and user interface security to be navigated around. Network Administrators would interact with Suricata at the Linux terminal and through editing its configuration file data stores, where access is based on the environment being secure. 

One potential gap we've identified is the security differences based on the [runmodes](https://docs.suricata.io/en/latest/performance/runmodes.html) being used. For our limited scope analysis, we used the most secure single process runmode for our analysis to limit the scope of concern and assume a more secure starting point. In industry, it would be critical to review these alternative runmodes for analysis since they would help with performance gains through leveraging multi-threading, load balancing, and more. Disabling multiple processes from being run is more secure and this was also brought up in our assurance case 4 where we pointed out the configuration hardening that can be done by enabling thread blocking.

Another aspect of the the TMT analysis was the highlighting of the potential concerns regarding authentication and authorization as a part of threat descriptions generated by the tool. While some threats generated by the tool offered a descriptor of enhancement for Suricata, in some cases we have found that the descriptors applied to components were found to be outside the scope of what Suricata could offer as a part of its design. An example of this occurance can seen in threat 40 under the "System Event Result" interaction within the TMT report in which the tool recommended a review of authorization settings for Suricata to further secure output files from attackers. This was found to be outside of the scope of the software as Suricata does not possess any authorization settings currently for this purpose and this would be handled by the operating system running Suricata. Another suggestion from the tool was for threat 16 under the "Suricata Data Request" interaction. With this threat, the suggestion provided by the tool was to consider a form authentication to mitigate spoofing done by those attempting to pose as legitimate users interacting with the system running Suricata. It is important to note that Suricata does not implement authentication at this time. However, consideration could be argued as a feature implementation within Suricata or for it to remain as an action covered by the operating system or external services.

When reviewing the threat report an additional topic of discussion observed from multiple threats suggested was the topic of encryption and its inclusion within Suricata for strengthening security. While Suricata is designed with support for handling different of types of encryption in order to read and compare network traffic against rulesets when contents are inaccessible, the tool does not encrypt its own system data. The suggestion provided by the tool could be seen as outside the scope of Suricata's implementation, but is worth noting due to a concern for ensuring the security of the data flows occuring wtihin the software system. 

A final area observed with the TMT anaylsis was understanding the severity of the threats generated by the tool with respect to the Suricata system. We initially thought that all threats generated by the tool analysis were set to high priority by default but later found out the software actually takes STRIDE into consideration when determining the priority. The tool assigns priority based on information entered in while creating the diagram, but we found that manual intervention was necessary in certain instances to more accurately reflect the needs of the OSS system priorities based on our own risk tolerance and the operational environment. In this case data from a hospital is much more important in the sense of Personally Identifiable Information (PII). When we are referring to information, the importance of data being handled could lead to the priority of threats highlighted by the tool as being of higher emphasis to account for the weight of the data being passed along the network through Suricata such as in the case of our hospital environment.

### [GITHUB Project Board Link](https://github.com/orgs/UNO-CYBR-8420-Team1/projects/1/views/2)
### Individual Contributions
- Ben
  - My contribution to this milestone was helping develop an inital day one DFD to get the ball rolling. The inital diagram helped mold more iterations to the finalized DFD. In addition to this I joined my team with the professor for further feedback on project and later in bouncing ideas off of each other as a group to hone in our final product. After that we were able to work each individually on threats identified from TMT analysis and break up those and work together as a group on them while reviewing each others. Lastly, continued group check ins keeping the team aligned and on task, along with bringing the team to the finish line.
- Grace
  - For this assignment, I contributed by creating an individual Data Flow Diagram (DFD) to support the brainstorming of ideas and provide a clear visualization of the system's components, data flows, and trust boundaries. Additionally, I assessed 10 specific threats using the Microsoft Threat Modeling Tool (TMT), analyzing their impact, justification, and mitigation status. My work contributed to help the team understand DFD making sure we were on the right track.
- Shane
  - For the threat modeling assignment, I have contributed to my group through providing a DFD draft to further iterate on design considerations for the group to use in working together to form our final DFD iteration. Once the final DFD was in place, I helped with filling in the report for the threat analysis by addressing 10 of 50 entries generated by the tool. Aside from creating a DFD diagram draft and covering threats on the threat report, I have participated in all group discussions in working the deliverable as well as assisting with the editing process in getting the deliverable ready for submission.
- Matt
  - For my contributions to the Designing for Software Security Engineering deliverable, I created a Level 1 Data Flow Diagram for group discussion. I attended both the check-in with Dr. Gandhi on Wednesday and our regular team meeting on Friday. I actively participated in group discussions to finalize a single diagram. Once the team decided on a Data Flow Diagram that best matched Suricata’s process, the threats automatically generated by Microsoft’s Threat Modeling Tool were divided among all team members. My assignments were threat IDs 62-68, 75, 76, and 78. I evaluated the assigned threats and determined whether the threat was not applicable to Suricata, if the threat had been mitigated by an Assurance Case, or if the threat needed further investigation. Once completed, my changes were uploaded to GitHub to be a part of the final deliverable.
- Nathan
  - I created an initial DFD as Level 0 and Level 1 to get the ball started with conversations (despite some errors as noted in the team meeting). I tried to help on the team meetings by screensharing and revising the DFD as a group together by guiding the team based on use/misuse cases. Grace and Shane made some good points about "run modes" and I tried to keep the scope contained so that we could move onto the threat mitigation efforts and further. In the mean time I added more to the structure of the submission document here to move us forward. I provided some concerns with the final revisions we made to the DFD. Once the diagram was finalized, I pointed out concerns about the TM7 file extension being supported in GITHUB merge correctly and test it with Ben before we moved forward. Then I contributed my assigned 11 to 20 entries as well as some initial gap comparison notes in part 2 of the assignment here. I specifically highlighted the “run mode” and limitations of the security analysis due to a large portion based on the environment being secure that it operations in. 

### Team Reflection
This milestone working on the Data Flow Diagrams (DFDs) a few issues we ran into initially were making sure to keep the diagram simple, reducing noise of the diagram for better readability for the user and preventing distractions. Our team working on designs wants to keep a thorough understanding of the system but can run into the problem of sometimes over complicating by adding additional external interactions with how the system works not in just the system only environment. Our initial diagrams were trying to incorporate Security Information and Event Manager (SIEM) to show further explanation of possible vulnerabilities, but this ended up being out of the scope of the system specific functionality (back to reducing noise). Another area was expecting there to be a generic data flow for both to and from which was not always the case and we found out could actually end up needing a separate process for if that was always the case. The best way we were able to attack the issues above was by simplifying but not distorting the topics. There were no additional external interactors that needed to be included in the system view if they were not directly related to the system itself. Our group was able to create a few different DFDs and continued to refine to be able to get a more concise deliverable, which after iterations made it clear of troubles we were running into at each step. The plan moving forward is to continue to focus on the system itself without having external interactors such as SIEM distort our view of the system or entice us to add more information than necessary that could distract the customer from what we should be presenting as the final product of the DFD.
