# Designing for Software Security Engineering
## Part 1: Threat Modeling
### Data Flow Diagram
![Diagram](https://github.com/UNO-CYBR-8420-Team1/CYBR8420-Suricata/blob/main/Threat%20Modeling%20Brainstorm/Final%20DFD%20Design%20Image.png)
### [HTML Report From Microsoft Threat Modeling Tool](https://htmlpreview.github.io/?https://github.com/UNO-CYBR-8420-Team1/CYBR8420-Suricata/blob/main/Threat%20Modeling%20Brainstorm/Suricata%20DFD%20Report.htm)
## Part 2: Observations
### Design Related Issues With Suricata

One observation we've seen with the threat analysis is the security of the system is really rooted in the security of the environment it runs in. We interpret this with the observation from the threat modeling tool analysis that the data Suricata stores and interacts with are local files that it generates or reads from. An example to reinforce this observation is the lack of a "login" and user interface security navigated around. Network Administrators would interact with Suricata at the Linux terminal and through editing its configuration file data stores, where access is based on the environment being secure. 

One potential gap we've identified is the security differences based on the [runmodes](https://docs.suricata.io/en/latest/performance/runmodes.html) being used. For our limited scope analysis, we used the most secure single process runmode for our analysis to limit the scope of concern and assume a more secure starting point. In industry, it would be critical to review these alternative runmodes for analysis since they would help with performance gains through leveraging multi-threading, load balancing, and more. Disabling multiple processes from being ran is more secure and this was also brought up in our assurance case 4 where we pointed out the configuration hardening that can be done by enabling thread blocking.

Another aspect of the the TMT analysis was the highlighting of the potential concerns regarding authentication and authorization as a part of threat description generated by the tool. While some threats generated by the tool offered a descriptor of enhancement for Suricata, in some cases we have found that the descriptors applied to components that were found to be outside the scope of what Suricata could offer as a part of its design. An example of this occurance can seen in threat 40 under the "System Event Result" interaction within the TMT report in which the tool recommended a review of authorization settings for Suricata to further secure output files from attackers. This was found to be outside of the scope of the software as Suricata does not possess any authorization settings currently for this purpose and this would be handled by the operating system running Suricata. Another suggestion from the tool was for threat 16 under the "Suricata Data Request" interaction. With this threat the suggestion provided by the tool was consider a form authentication to mitigate spoofing done by those attempting to pose as legitimate users interacting with the system running Suricata. It is important to note that Suricata does not implement authentication at this time. However, consideration could be argued as a some implement within Suricata as a feature or remain as a action covered by the operation or external services.

External Measures to Discuss (Fill these thoughts out further as separate paragraphs)
- TMT tool helps open a perspective of ways to mitigate threats, but we found some threats within our TMT analysis aligned with tools that can integrate with Suricata to help with better mitigate said threats
- Understanding the severity of the threats generated by the tool with respect to Suricata. We thought intially that all threats generated by the TMT tool analysis were set to high priority by default. We found that the tool assigned priorities based on information entered in while creating the diagram, but manual intervention was necessary in certain instances to more accurately reflect priorities based on our own risk tolerence and operational environment

### [GITHUB Project Board Link](https://github.com/orgs/UNO-CYBR-8420-Team1/projects/1/views/2)
### Individual Contributions
- Ben
  - My contribution to the project is 
- Grace
  - For this assignment, I contributed by creating an individual Data Flow Diagram (DFD) to support the brainstorming of ideas and provide a clear visualization of the system's components, data flows, and trust boundaries. Additionally, I assessed 10 specific threats using the Microsoft Threat Modeling Tool (TMT), analyzing their impact, justification, and mitigation status. My work contributed to help the team understand DFD making sure we were on the right track.
- Shane
  - place text here
- Matt
  - place text here
- Nathan
  - Nathan created an initial DFD as Level 0 and Level 1 to get the ball started with conversations (despite some errors as noted in the team meeting). He tried to help on the team meetings by screensharing and revising the DFD as a group together by guiding the team based on use/misuse cases. Grace and Shane made some good points about "run modes" and Nathan tried to keep the scope contained so that we could move onto the threat mitigation efforts and further. In the mean time ge added more to the structure of the submission document here to move us forward. He provided some concerns with the final revisions we made to the DFD. Once the diagram was finalized, he pointed out concerns about the TM7 file extension being supported in GITHUB merge correctly and test it with Ben before we moved forward. Then he contributed my assigned 11 to 20 entries as well as some initial gap comparison notes in part 2 of the assignment here. He specifically highlighted the “run mode” and limitations of the security analysis due to a large portion based on the environment being secure that it operations in. 

### Team Reflection
This milestone working on the Data Flow Diagrams (DFDs) a few issues we ran into initially were making sure to keep the diagram simple, reducing noise of the diagram for better readability for the user and preventing distractions. Our team working on designs wants to keep a thorough understanding of the system but can run into the problem of sometimes over complicating by adding additional external interactions with how the system works not in just the system only environment. Our initial diagrams were trying to incorporate Security Information and Event Manager (SIEM) to show further explanation of possible vulnerabilities, but this ended up being out of the scope of the system specific functionality (back to reducing noise). Another area was expecting there to be a generic data flow for both to and from which was not always the case and we found out could actually end up needing a separate process for if that was always the case. The best way we were able to attack the issues above was by simplifying but not distorting the topics. There were no additional external interactors that needed to be included in the system view if they were not directly related to the system itself. Our group was able to create a few different DFDs and continued to refine to be able to get a more concise deliverable, which after iterations made it clear of troubles we were running into at each step. The plan moving forward is to continue to focus on the system itself without having external interactors such as SIEM distort our view of the system or entice us to add more information than necessary that could distract the customer from what we should be presenting as the final product of the DFD.
